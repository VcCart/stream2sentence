# Stream2Sentence

Библиотека для обработки и выдачи предложений из непрерывного потока символов или текстовых фрагментов в реальном времени. Универсальная версия с поддержкой стихов, обычного текста, плавной обработкой и точными паузами.

## Особенности

- **Реальное время**: Генерация предложений из потокового текста с минимальной задержкой
- **Универсальность**: Поддержка как прозаического, так и поэтического текста
- **Умная токенизация**: Интеграция с Stanza и NLTK для точного определения границ предложений
- **Гибкая настройка**: Множество параметров для баланса между скоростью и точностью
- **Оптимизация для XTTS2**: Специальные настройки для синтеза речи
- **Поддержка русского языка**: Улучшенная обработка особенностей русского языка

## Установка

```bash
pip install git+https://github.com/VcCart/stream2sentence
```

Для использования Stanza токенизатора (рекомендуется):
```bash
pip install stanza==v1.11.0
```

### Основные параметры

- `generator`: Входной генератор текста (синхронный или асинхронный)
- `context_size`: Размер контекста для обнаружения границ предложений (по умолчанию: 15)
- `minimum_sentence_length`: Минимальная длина предложения (по умолчанию: 12)
- `minimum_first_fragment_length`: Минимальная длина первого фрагмента (по умолчанию: 8)
- `tokenizer`: Выбор токенизатора ("stanza" или "nltk", по умолчанию: "stanza")
- `language`: Язык для токенизации (по умолчанию: "ru")

### Параметры производительности

- `quick_yield_single_sentence_fragment`: Быстрая выдача первого фрагмента
- `quick_yield_for_all_sentences`: Быстрая выдача всех предложений
- `max_buffer_size`: Максимальный размер буфера (по умолчанию: 700)
- `tokenization_interval`: Интервал токенизации (по умолчанию: 6)

### Специальные режимы

- `poetic_mode`: Режим для обработки поэзии
- `preserve_line_breaks`: Сохранение переносов строк
- `strict_punctuation_mode`: Строгий режим пауз только на знаках препинания
- `cleanup_text_emojis`: Удаление эмодзи из текста

## Инициализация токенизаторов

### Stanza (рекомендуется)

```python
from stream2sentence import init_tokenizer

init_tokenizer("stanza", language="ru", offline=False)
```

### NLTK

```python
from stream2sentence import init_tokenizer

init_tokenizer("nltk", debug=True)
```

## Типы разделителей

Библиотека использует интеллектуальную систему разделителей:

**Сильные разделители** (длинные паузы):
- `. ! ? \n … ?` - конец предложения

**Слабые разделители** (короткие паузы):
- `, ; : —` - границы внутри сложных предложений

**Игнорируемые символы** (без пауз):
- `" ' ( ) [ ] { } « »` - кавычки и скобки

## Особенности для русского языка

- Умное распознавание аббревиатур с точками
- Фильтрация ложных границ предложений в коротких фрагментах
- Специальная обработка запятых в коротких словах
- Оптимизированные паузы для естественного звучания

## Советы по использованию

1. **Для TTS приложений**: Используйте `quick_yield_single_sentence_fragment=True`
2. **Для точной обработки**: Выбирайте Stanza токенизатор
3. **Для поэзии**: Включайте `poetic_mode` и `preserve_line_breaks`
4. **Для отладки**: Используйте `debug=True` для подробного вывода


Разработано для обеспечения плавного и естественного преобразования текста в речь в реальном времени с поддержкой особенностей русского языка.
